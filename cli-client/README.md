# **se2414 CLI Client**

Το **se2414 CLI Client** είναι ένα εργαλείο γραμμής εντολών που επιτρέπει στους χρήστες να αλληλεπιδρούν με το **API του Softeng24-14**. Παρέχει δυνατότητες **CRUD λειτουργιών** μέσω endpoints REST API, με χαρακτηριστικά όπως **πιστοποίηση χρηστών**, **έλεγχος πρόσβασης βάσει ρόλων** και **καθαρή μορφοποίηση δεδομένων**. Το CLI προσφέρει έναν ασφαλή και φιλικό προς τον χρήστη τρόπο προβολής και διαχείρισης δεδομένων διοδίων.

---

## **📚 Πίνακας Περιεχομένων**
- [Χαρακτηριστικά](#χαρακτηριστικά)
- [Εγκατάσταση](#εγκατάσταση)
- [Πιστοποίηση](#πιστοποίηση)
- [Χρήση](#χρήση)
  - [Σύνδεση](#σύνδεση)
  - [Αποσύνδεση](#αποσύνδεση)
  - [Ποιος είμαι (whoami)](#ποιος-είμαι-whoami)
  - [Διελεύσεις σταθμών διοδίων](#διελεύσεις-σταθμών-διοδίων)
  - [Ανάλυση διελεύσεων](#ανάλυση-διελεύσεων)
  - [Κόστος διελεύσεων](#κόστος-διελεύσεων)
  - [Χρεώσεις ανά φορέα](#χρεώσεις-ανά-φορέα)
- [Διαχειριστικές Λειτουργίες](#διαχειριστικές-λειτουργίες)
  - [usermod](#usermod)
  - [users](#users)
  - [addpasses](#addpasses)
- [Ρόλοι χρηστών](#ρόλοι-χρηστών)
- [Διαχείριση Σφαλμάτων](#διαχείριση-σφαλμάτων)
- [Δομή Αρχείων](#δομή-αρχείων)

---

## **✨ Χαρακτηριστικά**
- **CRUD λειτουργίες** μέσω endpoints του REST API.
- **Έλεγχος πρόσβασης με ρόλους** για **διαχειριστές** και **χρήστες εταιρειών διοδίων**.
- **Σύστημα πιστοποίησης** με λειτουργίες σύνδεσης/αποσύνδεσης.
- **Περιορισμός πολλαπλών συνδέσεων** — πρέπει να αποσυνδεθείτε για να συνδεθείτε με νέο χρήστη.
- **Εμφάνιση τρέχοντος χρήστη** με την εντολή **whoami**.
- **Καθαρή μορφοποίηση εξόδου** για δεδομένα.
- **Επαλήθευση εντολών και χειρισμός σφαλμάτων** για εσφαλμένα ή ελλιπή δεδομένα.
- **Ασφαλής αποθήκευση των διαπιστευτηρίων** μέσω του αρχείου `token.json`.

---

## **📦 Εγκατάσταση**
Ακολουθήστε τα παρακάτω βήματα για να ρυθμίσετε και να χρησιμοποιήσετε το **se2414 CLI Client**.

1. **Κλωνοποίηση του αποθετηρίου**
   ```bash
   git clone https://github.com/ntua/softeng24-14.git
   ```

2. **Πλοήγηση στον κατάλογο του CLI**
   ```bash
   cd softeng24-14/cli-client
   ```

3. **Εγκατάσταση εξαρτήσεων**
   ```bash
   npm install
   ```

4. **Σύνδεση του CLI παγκοσμίως**
   ```bash
   npm link
   ```

> **Σημείωση:** Με το link, μπορείτε να χρησιμοποιείτε την εντολή `se2414` από οπουδήποτε στο σύστημά σας.

5. **Επαλήθευση εγκατάστασης**
   ```bash
   se2414 --help
   ```

---

## **🔐 Πιστοποίηση**
Για να χρησιμοποιήσετε το CLI, πρέπει πρώτα να **συνδεθείτε**. Το σύστημα υποστηρίζει τους παρακάτω χρήστες:
- **Διαχειριστής (Admin)**: Έχει πρόσβαση σε όλες τις εντολές.
- **Χρήστες εταιρειών διοδίων**: Μπορούν να δουν μόνο τα δεδομένα της δικής τους εταιρείας.

---

## **🚀 Χρήση**

### **1. Σύνδεση**
```bash
se2414 login --username <όνομα_χρήστη> --passw <κωδικός>
```

Αν είστε ήδη συνδεδεμένοι ως κάποιος χρήστης, θα πρέπει να αποσυνδεθείτε πρώτα:
```
You are already logged in as 'admin'. Please logout before logging in as a new user.
```

---

### **2. Αποσύνδεση**
```bash
se2414 logout
```

Αφαιρεί το **token.json** και αποσυνδέει τον χρήστη.

---

### **3. Ποιος είμαι (whoami)**
```bash
se2414 whoami
```

Εμφανίζει το όνομα, την εταιρεία και το ρόλο του συνδεδεμένου χρήστη.

---

### **4. Διελεύσεις σταθμών διοδίων**
```bash
se2414 tollstationpasses --station <σταθμός> --from <ημερομηνία> --to <ημερομηνία> --format <μορφή>
```

---

### **5. Ανάλυση διελεύσεων**
```bash
se2414 passanalysis --stationop <φορέας_1> --tagop <φορέας_2> --from <ημερομηνία> --to <ημερομηνία>
```

---

### **6. Κόστος διελεύσεων**
```bash
se2414 passescost --stationop <φορέας_1> --tagop <φορέας_2> --from <ημερομηνία> --to <ημερομηνία>
```

---

### **7. Χρεώσεις ανά φορέα**
```bash
se2414 chargesby --opid <id_φορέα> --from <ημερομηνία> --to <ημερομηνία>
```

---

## **⚙️ Διαχειριστικές Λειτουργίες**

### **1. usermod**
```bash
se2414 admin usermod --username <όνομα_χρήστη> --passw <κωδικός>
```
Δημιουργεί ή ενημερώνει έναν χρήστη.

---

### **2. users**
```bash
se2414 admin users
```
Εμφανίζει τη λίστα όλων των χρηστών.

---

### **3. addpasses**
```bash
se2414 admin addpasses --source <αρχείο_διελεύσεων.csv>
```
Προσθέτει διελεύσεις διοδίων από αρχείο CSV.

---

## **👥 Ρόλοι χρηστών**
| **Όνομα Χρήστη**  | **Εταιρεία**        | **Ρόλος** |
|-------------------|---------------------|-----------|
| **admin**         | -                   | **admin** |
| **aegean_user**   | **aegean_motorway** | **user**  |
| **egnatia_user**  | **egnatia_odos**    | **user**  |
| **kentriki_user** | **kentriki_odos**   | **user**  |
| **moreas_user**   | **moreas**          | **user**  |
| **attiki_user**   | **attiki_odos**     | **user**  |
| **nea_user**      | **nea_odos**        | **user**  |
| **olympia_user**  | **olympia_odos**    | **user**  |

Οι χρήστες των εταιρειών μπορούν να βλέπουν μόνο δεδομένα της εταιρείας τους. Ο διαχειριστής (**admin**) έχει πρόσβαση σε όλα τα δεδομένα.

---

## **📁 Δομή Αρχείων**
```
project/
  ├── cli-client/
  │    └── cli.js
  │    └── users.json
  │    └── token.json (Αυτόματη δημιουργία)
  └── package.json
```